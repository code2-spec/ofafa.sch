<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Test Application Form</title>
</head>
<body>
  <h2>Application Form</h2>
  <form id="applyForm">
    <label for="FirstName">First Name:</label><br />
    <input type="text" id="FirstName" name="FirstName" autocomplete="given-name" required /><br /><br />

    <label for="SecondName">Second Name:</label><br />
    <input type="text" id="SecondName" name="SecondName" autocomplete="additional-name" /><br /><br />

    <label for="LastName">Last Name:</label><br />
    <input type="text" id="LastName" name="LastName" autocomplete="family-name" required /><br /><br />

    <label for="Email">Email:</label><br />
    <input type="email" id="Email" name="Email" autocomplete="email" required /><br /><br />

    <label for="Phone">Phone:</label><br />
    <input type="tel" id="Phone" name="Phone" autocomplete="tel" /><br /><br />

    <label for="Birthdate">Birthdate:</label><br />
    <input type="date" id="Birthdate" name="Birthdate" autocomplete="bday" /><br /><br />

    <label for="Age">Age:</label><br />
    <input type="number" id="Age" name="Age" /><br /><br />

    Gender:<br />
    <label><input type="radio" name="Gender" value="Male" /> Male</label>
    <label><input type="radio" name="Gender" value="Female" /> Female</label>
    <label><input type="radio" name="Gender" value="Other" /> Other</label><br /><br />

    <label for="COURSE">Course:</label><br />
    <input type="text" id="COURSE" name="COURSE" /><br /><br />

    <label for="Comment">Comment:</label><br />
    <textarea id="Comment" name="Comment"></textarea><br /><br />

    <button type="submit">Submit Application</button>
  </form>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const form = document.getElementById('applyForm');

      form.addEventListener('submit', function (e) {
        e.preventDefault();

        const gender = form.querySelector('input[name="Gender"]:checked')?.value || '';

        const formData = {
          FirstName: form.FirstName.value,
          SecondName: form.SecondName.value,
          LastName: form.LastName.value,
          Email: form.Email.value,
          Phone: form.Phone.value,
          Birthdate: form.Birthdate.value,
          Age: form.Age.value,
          Gender: gender,
          COURSE: form.COURSE.value,
          Comment: form.Comment.value
        };

        fetch('https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        })
        .then(response => {
          if (!response.ok) throw new Error('Network response was not ok ' + response.statusText);
          return response.text();
        })
        .then(result => {
          alert("Application submitted successfully!");
          form.reset();
        })
        .catch(error => {
          console.error('Submission failed:', error);
          alert("There was an error submitting the form.");
        });
      });
    });
  </script>
</body>
</html>
